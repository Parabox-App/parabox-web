{"version":3,"file":"foundation.js","sourceRoot":"","sources":["foundation.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n// TODO(b/242194005): remove MDC deps\nimport {isNavigationEvent, KEY, normalizeKey} from '@material/web/compat/dom/keyboard.js';\n\nimport {MDCChipActionAdapter} from './adapter.js';\nimport {MDCChipActionAttributes, MDCChipActionEvents, MDCChipActionFocusBehavior, MDCChipActionInteractionTrigger, MDCChipActionType} from './constants.js';\nimport {MDCChipActionInteractionEventDetail, MDCChipActionNavigationEventDetail} from './types.js';\n\nconst triggerMap = new Map<string, MDCChipActionInteractionTrigger>();\ntriggerMap.set(KEY.SPACEBAR, MDCChipActionInteractionTrigger.SPACEBAR_KEY);\ntriggerMap.set(KEY.ENTER, MDCChipActionInteractionTrigger.ENTER_KEY);\ntriggerMap.set(KEY.DELETE, MDCChipActionInteractionTrigger.DELETE_KEY);\ntriggerMap.set(KEY.BACKSPACE, MDCChipActionInteractionTrigger.BACKSPACE_KEY);\n\n\n/**\n * MDCChipActionFoundation provides a base abstract foundation for all chip\n * actions.\n */\nexport abstract class MDCChipActionFoundation {\n  protected readonly adapter: MDCChipActionAdapter;\n\n  static get defaultAdapter(): MDCChipActionAdapter {\n    return {\n      emitEvent: () => undefined,\n      focus: () => undefined,\n      getAttribute: () => null,\n      getElementID: () => '',\n      removeAttribute: () => undefined,\n      setAttribute: () => undefined,\n    };\n  }\n\n  constructor(adapter: Partial<MDCChipActionAdapter>) {\n    this.adapter = {...MDCChipActionFoundation.defaultAdapter, ...adapter};\n  }\n\n  handleClick() {\n    // Early exit for cases where the click comes from a source other than the\n    // user's pointer (i.e. programmatic click from AT).\n    if (this.isDisabled()) return;\n    this.emitInteraction(MDCChipActionInteractionTrigger.CLICK);\n  }\n\n  handleKeydown(event: KeyboardEvent) {\n    const key = normalizeKey(event);\n    if (this.shouldNotifyInteractionFromKey(key)) {\n      event.preventDefault();\n      this.emitInteraction(this.getTriggerFromKey(key));\n      return;\n    }\n\n    if (isNavigationEvent(event)) {\n      event.preventDefault();\n      this.emitNavigation(key);\n      return;\n    }\n  }\n\n  setDisabled(isDisabled: boolean) {\n    // Use `aria-disabled` for the selectable (listbox) disabled state\n    if (this.isSelectable()) {\n      this.adapter.setAttribute(\n          MDCChipActionAttributes.ARIA_DISABLED, `${isDisabled}`);\n      return;\n    }\n\n    if (isDisabled) {\n      this.adapter.setAttribute(MDCChipActionAttributes.DISABLED, 'true');\n    } else {\n      this.adapter.removeAttribute(MDCChipActionAttributes.DISABLED);\n    }\n  }\n\n  isDisabled(): boolean {\n    if (this.adapter.getAttribute(MDCChipActionAttributes.ARIA_DISABLED) ===\n        'true') {\n      return true;\n    }\n\n    if (this.adapter.getAttribute(MDCChipActionAttributes.DISABLED) !== null) {\n      return true;\n    }\n\n    return false;\n  }\n\n  setFocus(behavior: MDCChipActionFocusBehavior) {\n    // Early exit if not focusable\n    if (!this.isFocusable()) {\n      return;\n    }\n\n    // Add it to the tab order and give focus\n    if (behavior === MDCChipActionFocusBehavior.FOCUSABLE_AND_FOCUSED) {\n      this.adapter.setAttribute(MDCChipActionAttributes.TAB_INDEX, '0');\n      this.adapter.focus();\n      return;\n    }\n\n    // Add to the tab order\n    if (behavior === MDCChipActionFocusBehavior.FOCUSABLE) {\n      this.adapter.setAttribute(MDCChipActionAttributes.TAB_INDEX, '0');\n      return;\n    }\n\n    // Remove it from the tab order\n    if (behavior === MDCChipActionFocusBehavior.NOT_FOCUSABLE) {\n      this.adapter.setAttribute(MDCChipActionAttributes.TAB_INDEX, '-1');\n      return;\n    }\n  }\n\n  isFocusable() {\n    if (this.isDisabled()) {\n      return false;\n    }\n\n    if (this.adapter.getAttribute(MDCChipActionAttributes.ARIA_HIDDEN) ===\n        'true') {\n      return false;\n    }\n\n    return true;\n  }\n\n  setSelected(isSelected: boolean) {\n    // Early exit if not selectable\n    if (!this.isSelectable()) {\n      return;\n    }\n\n    this.adapter.setAttribute(\n        MDCChipActionAttributes.ARIA_SELECTED, `${isSelected}`);\n  }\n\n  isSelected(): boolean {\n    return this.adapter.getAttribute(MDCChipActionAttributes.ARIA_SELECTED) ===\n        'true';\n  }\n\n  private emitInteraction(trigger: MDCChipActionInteractionTrigger) {\n    this.adapter.emitEvent<MDCChipActionInteractionEventDetail>(\n        MDCChipActionEvents.INTERACTION, {\n          actionID: this.adapter.getElementID(),\n          source: this.actionType(),\n          trigger,\n        });\n  }\n\n  private emitNavigation(key: string) {\n    this.adapter.emitEvent<MDCChipActionNavigationEventDetail>(\n        MDCChipActionEvents.NAVIGATION, {\n          source: this.actionType(),\n          key,\n        });\n  }\n\n  private shouldNotifyInteractionFromKey(key: string): boolean {\n    const isFromActionKey = key === KEY.ENTER || key === KEY.SPACEBAR;\n    const isFromRemoveKey = key === KEY.BACKSPACE || key === KEY.DELETE;\n\n    if (isFromActionKey) {\n      return true;\n    }\n\n    if (isFromRemoveKey && this.shouldEmitInteractionOnRemoveKey()) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private getTriggerFromKey(key: string): MDCChipActionInteractionTrigger {\n    const trigger = triggerMap.get(key);\n    if (trigger) {\n      return trigger;\n    }\n\n    // Default case, should ideally never be returned\n    return MDCChipActionInteractionTrigger.UNSPECIFIED;\n  }\n\n  abstract actionType(): MDCChipActionType;\n\n  abstract isSelectable(): boolean;\n\n  protected abstract shouldEmitInteractionOnRemoveKey(): boolean;\n}\n"]}